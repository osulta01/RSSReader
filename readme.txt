More powerful version here: https://gist.github.com/1178136

Also see https://gist.github.com/255291#file_parabolic.py for interpolating to get sharp intersample peaks